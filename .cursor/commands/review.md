Thank you, AI S.

---- Switching from AI S to AI 5 ----

AI 5, please review the plan and implementation changes from AI S above. Special focus on improving code readability, future maintainability, consistency with rules and other code, security issues, and bugs. Leave your feedback for AI S to improve.
